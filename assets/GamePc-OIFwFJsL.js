import{t as A,r as p,g as k,s as C,j as a}from"./index-TAAB46RF.js";import{K as L,N as x,a8 as c,ap as q,b as o,au as y,i as z,U as $,f as G}from"./useAuthNavi-1jCOrt3A.js";const T=""+new URL("gamebg-DZsCccmm.webp",import.meta.url).href;function B(){const g=!!location.search.match("roomId"),j=L(),[n]=A(),[w,m]=p.useState(""),s=n.get("game")||"",i=p.useRef(null);p.useEffect(()=>(x.getV()?I():r(),window.addEventListener("message",u),()=>{P(),window.removeEventListener("message",u)}),[n]);function u(e){if(e.data.source!=="react-devtools-content-script"&&!e.data.wappalyzer){if(e.data.name==="openCashier"){window.removeEventListener("message",u),console.warn("from iframe",e),c.fail(k("nomoney")),r();return}if(e.data==="disconnect"){console.warn("from iframe",e),r();return}if(e.data==="gameend"){console.warn("from iframe",e),c.fail(k("nomoney")),r();return}}}async function I(){if(!g){i.current.setAttribute("allowfullscreen","true"),i.current.setAttribute("webkitallowfullscreen","true"),i.current.setAttribute("mozallowfullscreen","true");let l=localStorage.getItem("pp")||"";m(l);return}let e=n.get("roomId")||1,b=n.get("bets")||"",S=n.get("min")||"";e=="undefined"&&(e=1);const f=await N();let U=f.apiUrl,E=f.token,d=f.gameId;const R=new Date().getTime();let t=`https://www.tigerslot.fun/game1/?game=${s}&apiUrl=${U}&token=${E}&roomId=${e}&min=${S}&timestamp=${R}`;b&&(t+=`&bets=${b}`);const h=x.getV();if(h){const{account:l,password:v}=h;l&&(t+=`&phone=${q.phonePre}${l}`),v&&(t+=`&password=${v}`)}if(C?t+="&device=mobile":t+="&device=desk",d===0)m(t);else{if(d===10001)if(s!="truco"){c.info("Por favor, complete o jogo de poker primeiro!"),r();return}else t+="&bRejoin=true";else if(d===10006)if(s!="cacheta"){c.info("Por favor, complete o jogo de poker primeiro!"),r();return}else t+="&bRejoin=true";else await o.request(y(s),{},"离开先前游戏");m(t)}}async function N(){try{return z.online||await o.relogin(),(await o.request($.getGameId,{},"")).data}catch{return{gameId:0}}}function r(){j("/",{replace:!0})}function P(){window.socket.readyState===WebSocket.OPEN?g?o.request(y(s),{},"离开先前游戏"):o.request($.leavePPGame,{}):o.relogin()}return a.jsxs("div",{className:"w-full",children:[a.jsx("div",{className:"mb-[0.1rem] flex items-center justify-start",children:a.jsxs("div",{className:"h-[0.34rem] px-[0.15rem] rounded-[0.04rem] cursor-pointer bg-[#2d3035] flex items-center",onClick:r,children:[a.jsx(G,{color:"gray"}),a.jsx("span",{className:"text-white text-[0.14rem] ml-[0.12rem] capitalize",children:s})]})}),a.jsx("div",{className:"w-full relative",style:{paddingTop:`${750/1624*100}%`,display:`${w==""?"none":""}`,backgroundImage:`url(${T})`,backgroundSize:"cover"},children:a.jsx("iframe",{src:w,className:"w-full h-full absolute top-0 left-0",ref:i})})]})}export{B as default};
