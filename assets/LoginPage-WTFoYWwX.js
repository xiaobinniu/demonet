import{u as U,r as a,j as t,N as G,g as E}from"./index-TAAB46RF.js";import{P as H}from"./PageBack-rZjQFXe2.js";import{s as d}from"./login.module-04NHvHkk.js";import{u as J,N as k,ao as i,t as h,g as Z,ap as D,ab as K,aq as Q,ar as X,c as $,i as I,M as F,as as Y,at as ee,a8 as te,b as se}from"./useAuthNavi-1jCOrt3A.js";import"./Language-5SG9CA13.js";const ae="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='26px'%20height='27px'%20viewBox='0%200%2026%2027'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3ctitle%3e%3c/title%3e%3cg%20id=''%20stroke='none'%20stroke-width='1'%20fill='none'%20fill-rule='evenodd'%3e%3cg%20id=''%20transform='translate(-199.000000,%20-208.000000)'%3e%3cg%20id=''%20transform='translate(199.000000,%20208.500000)'%3e%3ccircle%20id=''%20fill='%23FFFFFF'%20cx='13'%20cy='13'%20r='13'%3e%3c/circle%3e%3cg%20id='google-2'%20transform='translate(4.500000,%205.000000)'%20fill-rule='nonzero'%3e%3cg%20id='google'%3e%3cpath%20d='M3.55743847,8.5%20C3.55743847,7.94796727%203.65166543,7.41839257%203.81837464,6.92214267%20L0.891540636,4.73429643%20C0.303491494,5.90245673%20-0.0018826868,7.1923137%200,8.5%20C0,9.85327708%200.320380366,11.1297622%200.890090996,12.2628058%20L3.81547536,10.0713373%20C3.64490091,9.56497892%203.55775373,9.03428886%203.55743847,8.5'%20id='路径'%20fill='%23FBBC05'%3e%3c/path%3e%3cpath%20d='M8.69788096,3.47737152%20C9.9228313,3.47737152%2011.0296355,3.90190063%2011.8994228,4.59737493%20L14.4297788,2.12481888%20C12.8880809,0.811386693%2010.9114894,0%208.69788096,0%20C5.26077179,0%202.30639451,1.92342112%200.891540636,4.73429643%20L3.8198243,6.92214267%20C4.49390939,4.91830734%206.41613916,3.47737152%208.69788096,3.47737152'%20id='路径'%20fill='%23EA4335'%3e%3c/path%3e%3cpath%20d='M8.69788096,13.5226285%20C6.41541433,13.5226285%204.49318457,12.0816927%203.81837464,10.0778573%20L0.891540636,12.2657036%20C2.3056697,15.0765789%205.26004696,17%208.69788096,17%20C10.8187121,17%2012.8438667,16.2632319%2014.3645447,14.8817012%20L11.5855745,12.7793403%20C10.8020412,13.2625501%209.81483271,13.5226285%208.69715615,13.5226285'%20id='路径'%20fill='%2334A853'%3e%3c/path%3e%3cpath%20d='M17,8.5%20C17,7.99795449%2016.9202695,7.45678855%2016.8021234,6.95474303%20L8.69715615,6.95474303%20L8.69715615,10.2386858%20L13.3621149,10.2386858%20C13.1294469,11.3586892%2012.4945022,12.2193386%2011.5862994,12.7793403%20L14.3645447,14.8817012%20C15.9613291,13.4313475%2017,11.2710304%2017,8.5'%20id='路径'%20fill='%234285F4'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e";function ce({login:m}){const{t:r,i18n:R}=J(),x=U(),v=a.useRef(null),w=a.useRef(null),L=a.useRef(null),[g,P]=a.useState(!1),[n,j]=a.useState(""),[l,y]=a.useState(""),[C,V]=a.useState(""),[c,u]=a.useState(!1),[M,b]=a.useState(""),[N,S]=a.useState(0),p=a.useRef(0);a.useEffect(()=>(B(),()=>{p.current&&clearInterval(p.current)}),[]);function B(e){let s=k.getV(),o=e!==void 0?e:m;s&&o?(j(s.account),y(s.password),v.current.value=s.account,w.current.value=s.password):o||(j(""),y(""),v.current.value="",w.current.value="")}const f=a.useMemo(()=>m?i.phone(n)&&i.password(l):h.sms?i.phone(n)&&i.password(l)&&i.smscode(C):i.phone(n)&&i.password(l),[n,l,C,R.language]);function T(e){let s=e.target.value;j(s)}function W(e){let s=e.target.value;y(s)}function A(){m?q():z()}async function q(){if(f&&c==!1)try{u(!0);const e=await X(n,l);e.code==200?($.setValue("uid",e.uid),I.setValue("token",e.token),F.setLocalstorageWithExpiration("token",e.token,5),_(e.token),k.setV({account:n,password:l})):e.msg&&b(E(e.msg)),u(!1)}catch{u(!1)}}async function z(){if(f&&c==!1)try{u(!0);const e=await Y(n,l,C);e.code==200?($.setValue("uid",e.uid),I.setValue("token",e.token),F.setLocalstorageWithExpiration("token",e.token,5),_(e.token),k.setV({account:n,password:l})):e.msg&&b(E(e.msg)),u(!1)}catch{u(!1)}}function O(){i.phone(n)&&(N>0||(S(60),ee(n).then(e=>{e.smsCode&&te.info(e.smsCode)}),p.current=window.setInterval(()=>{S(e=>e===0?(clearInterval(p.current),0):e-1)},1e3)))}function _(e){se.init(e).then(()=>{x("/",{state:{animation:"fromRight"}})})}return a.useEffect(()=>(Z.fromTo(L.current,{right:"-100%"},{right:0,duration:.2}),()=>{}),[]),t.jsxs("div",{className:"w-full h-screen overflow-hidden bg-grayPage relative",ref:L,children:[t.jsx(H,{}),t.jsxs("div",{className:"p-[0.28rem_0.18rem_0]",style:{minHeight:"calc(100% - 1.11rem)"},children:[t.jsx("h2",{className:"text-[0.18rem] text-[#fcde26] font-bold text-center",children:r("loginwelcome")}),t.jsxs("div",{className:"m-[0.2rem_auto_0.08rem] bg-[#3f6bb3] w-[1.83rem] h-[0.42rem] rounded-[.04rem] flex justify-center items-center",style:{display:`${h.google?"flex":"none"}`},children:[t.jsx("img",{src:ae,alt:"",className:"w-[.26rem]"}),t.jsx("span",{className:"text-[.1rem] ml-[.13rem]",children:r("logingoogle")})]}),t.jsxs("div",{className:"mt-[.16rem] flex items-center",style:{opacity:`${h.google?1:0}`},children:[t.jsx("span",{className:"w-[1.55rem] bg-[#666] h-[1px]"}),t.jsx("span",{className:"text-[0.12rem] text-[#ddd] m-[0_0.03rem]",children:r("OU")}),t.jsx("span",{className:"w-[1.55rem] bg-[#666] h-[1px]"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"relative",children:[t.jsxs("span",{className:`text-[.14rem] ${d.inputicon}`,children:["+",D.phonePre]}),t.jsx("input",{type:"text",className:`${d.input} pl-[.28rem]`,placeholder:r("Número de Celular"),maxLength:11,onInput:e=>{const s=e.target,o=/[^\d]/g;s.value=s.value.replace(o,"")},onChange:T,ref:v})]}),t.jsxs("div",{className:"relative flex items-center justify-between",style:{opacity:!i.phone(n)||c?.4:1,display:`${m||h.sms==!1?"none":"flex"}`},children:[t.jsx("input",{type:`${g?"text":"password"}`,className:`${d.input} !w-2/3`,placeholder:r("sms"),maxLength:6,onInput:e=>{const s=e.target,o=/[^\d]/g;s.value=s.value.replace(o,"")},onChange:e=>V(e.target.value)}),t.jsx("button",{className:`${d.input} flex justify-center items-center !indent-0 !w-[30%] !bg-green !text-white`,style:{opacity:!i.phone(n)||c?.4:1},disabled:!i.phone(n)||c,onClick:O,children:N===0?r("smssend"):t.jsx(t.Fragment,{children:N})})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:`${g?"text":"password"}`,className:`${d.input}`,placeholder:r("Senha"),maxLength:20,onInput:e=>{const s=e.target,o=/[^a-zA-Z0-9!@#$%^&*(),.?":{}|<>]+/g;s.value=s.value.replace(o,"")},onChange:W,ref:w}),t.jsxs("div",{className:`text-[0.16rem] ${d["inputicon-after"]} !text-black`,onClick:()=>P(!g),children:[" ",g?t.jsx(K,{}):t.jsx(Q,{})]})]}),t.jsxs("div",{className:"m-[0.29rem_0_0.19rem]",children:[t.jsx("p",{className:"mb-[.06rem] text-center text-[#e53535] text-[0.12rem]",children:M}),t.jsx("button",{className:"h-[0.44rem] w-full bg-green text-white text-[.14rem] rounded-[4px]",style:{opacity:!f||c?.4:1},disabled:!f||c,onClick:A,children:r(m?"Login":"Criar conta")})]}),m?t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(G,{to:"/psw",className:"text-[0.12rem] text-white",children:r("Esqueci minha senha?")}),t.jsx("span",{className:"text-[0.12rem] text-white",onClick:()=>{x("/register",{replace:!0})},children:r("Criar Conta Nova")})]}):t.jsx("div",{className:"flex items-center justify-center",onClick:()=>{x("/login",{replace:!0})},children:t.jsx("span",{className:"text-[0.12rem] text-white",children:r("Já tem uma conta? Log in")})})]})]})]})}export{ce as default};
